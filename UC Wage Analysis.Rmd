---
title: "UC Wages"
author: "William Lovejoy"
date: "2/9/2022"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

The data for this project was requested from the University of California System via the FOIA. It contains the names, position, and gross yearly pay for all UC employees. The available data stretched from 2015 to 2020, and came in multiple separate csv and excel files. The only ones necessary for this project were CSV, so they were renamed to make organization easier before being added to R.

```{r reading}
library(dplyr)
library(scales)
library(ggplot2)


df_2015 <- read.csv("C:/Users/William Lovejoy/Documents/Codes/R/DataScience/UCWageCSV/2015.csv")
df_2016 <- read.csv("C:/Users/William Lovejoy/Documents/Codes/R/DataScience/UCWageCSV/2016.csv")
df_2017 <- read.csv("C:/Users/William Lovejoy/Documents/Codes/R/DataScience/UCWageCSV/2017.csv")
df_2018 <- read.csv("C:/Users/William Lovejoy/Documents/Codes/R/DataScience/UCWageCSV/2018.csv")
df_2019 <- read.csv("C:/Users/William Lovejoy/Documents/Codes/R/DataScience/UCWageCSV/2019.CSV")
df_2020 <- read.csv("C:/Users/William Lovejoy/Documents/Codes/R/DataScience/UCWageCSV/2020.csv")
```

As always, check the structure of all your dataframes. 

```{r structures, eval = FALSE}
str(df_2015)
str(df_2016)
str(df_2017)
str(df_2018)
str(df_2019)
str(df_2020)
```

One of these dataframes actually has a problem. One of the column names in df_2018 has a typo in it, which is something we'll need to fix in order to make sure it doesn't cause problems later.
```{r correction}
str(df_2018)
df_2018 <- rename(df_2018, Last = Lastt)
str(df_2018)
```
Next up, we'll combine the names columns to get a full name we can search through later if we want to, and then we can make some exploratory graphs.

```{r naming and graphing}
df_2015$Name <- paste(df_2015$First, df_2015$Last, sep = " ")
df_2016$Name <- paste(df_2016$First, df_2016$Last, sep = " ")
df_2017$Name <- paste(df_2017$First, df_2017$Last, sep = " ")
df_2018$Name <- paste(df_2018$First, df_2018$Last, sep = " ")
df_2019$Name <- paste(df_2019$First, df_2019$Last, sep = " ")
df_2020$Name <- paste(df_2020$First, df_2020$Last, sep = " ")

g <- ggplot(data = df_2015, mapping = aes(x = Location, y = X2015.Gross))
g + geom_boxplot(outlier.color = "blue") + scale_y_continuous(name = "2015 Gross Wages",labels = label_number(suffix = "k", scale = 1e-4)) +
  theme(axis.text.x = element_text(angle = 90)) + stat_summary(fun = mean, geom = "point", color = "red")
g + geom_violin() + scale_y_continuous(name = "2015 Gross Wages",labels = label_number(suffix = "k", scale = 1e-4)) +
  theme(axis.text.x = element_text(angle = 90)) + stat_summary(fun = mean, geom = "point", color = "red")

a <- ggplot(data = df_2016, mapping = aes(x = Location, y = X2016.Gross))
a + geom_boxplot(outlier.color = "blue") + scale_y_continuous(name = "2016 Gross Wages",labels = label_number(suffix = "k", scale = 1e-4)) +
  theme(axis.text.x = element_text(angle = 90)) + stat_summary(fun = mean, geom = "point", color = "red")
a + geom_violin() + scale_y_continuous(name = "2016 Gross Wages",labels = label_number(suffix = "k", scale = 1e-4)) +
  theme(axis.text.x = element_text(angle = 90)) + stat_summary(fun = mean, geom = "point", color = "red")

b <- ggplot(data = df_2017, mapping = aes(x = Location, y = X2017.Gross))
b + geom_boxplot(outlier.color = "blue") +  scale_y_continuous(name = "2017 Gross Wages",labels = label_number(suffix = "k", scale = 1e-4)) +
  theme(axis.text.x = element_text(angle = 90)) + stat_summary(fun = mean, geom = "point", color = "red")
b + geom_violin() +  scale_y_continuous(name = "2017 Gross Wages",labels = label_number(suffix = "k", scale = 1e-4)) +
  theme(axis.text.x = element_text(angle = 90)) + stat_summary(fun = mean, geom = "point", color = "red")

c <- ggplot(data = df_2018, mapping = aes(x = Location, y = X2018.Gross))
c + geom_boxplot(outlier.color = "blue") +  scale_y_continuous(name = "2018 Gross Wages",labels = label_number(suffix = "k", scale = 1e-4)) +
  theme(axis.text.x = element_text(angle = 90)) + stat_summary(fun = mean, geom = "point", color = "red")
c + geom_violin() +  scale_y_continuous(name = "2018 Gross Wages",labels = label_number(suffix = "k", scale = 1e-4)) +
  theme(axis.text.x = element_text(angle = 90)) + stat_summary(fun = mean, geom = "point", color = "red")

d <- ggplot(data = df_2019, mapping = aes(x = Location, y = X2019.Gross))
d + geom_boxplot(outlier.color = "blue") +  scale_y_continuous(name = "2019 Gross Wages",labels = label_number(suffix = "k", scale = 1e-4)) +
  theme(axis.text.x = element_text(angle = 90)) + stat_summary(fun = mean, geom = "point", color = "red")
d + geom_violin() +  scale_y_continuous(name = "2019 Gross Wages",labels = label_number(suffix = "k", scale = 1e-4)) +
  theme(axis.text.x = element_text(angle = 90)) + stat_summary(fun = mean, geom = "point", color = "red")

e <- ggplot(data = df_2020, mapping = aes(x = Location, y = X2020.Gross))
e + geom_boxplot(outlier.color = "blue") +  scale_y_continuous(name = "2020 Gross Wages",labels = label_number(suffix = "k", scale = 1e-2)) +
  theme(axis.text.x = element_text(angle = 90)) + stat_summary(fun = mean, geom = "point", color = "red")
e + geom_violin() +  scale_y_continuous(name = "2020 Gross Wages",labels = label_number(suffix = "k", scale = 1e-2)) +
  theme(axis.text.x = element_text(angle = 90)) + stat_summary(fun = mean, geom = "point", color = "red")


```
At first glance, these are not very evenly distributed graphs. The outliers take up so much space, and are so frequent, that they compress the rest of the data. However these charts also include the data from student workers, which typically wont be making as much money as someone working as a regular employee. So we're going to remove the student data, and remake the graphs.
```{r graphing 2}
df_2015 <- subset(df_2015, First != "*****")
df_2016 <- subset(df_2016, First != "*****")
df_2017 <- subset(df_2017, First != "*****")
df_2018 <- subset(df_2018, First != "*****")
df_2019 <- subset(df_2019, First != "*****")
df_2020 <- subset(df_2020, First != "*****")

h <- ggplot(data = df_2015, mapping = aes(x = Location, y = X2015.Gross))
h + geom_boxplot(outlier.color = "blue") + scale_y_continuous(name = "2015 Gross Wages",labels = label_number(suffix = "k", scale = 1e-4)) +
  theme(axis.text.x = element_text(angle = 90)) + stat_summary(fun = mean, geom = "point", color = "red")
h + geom_violin() + scale_y_continuous(name = "2015 Gross Wages",labels = label_number(suffix = "k", scale = 1e-4)) +
  theme(axis.text.x = element_text(angle = 90)) + stat_summary(fun = mean, geom = "point", color = "red")

i <- ggplot(data = df_2016, mapping = aes(x = Location, y = X2016.Gross))
i + geom_boxplot(outlier.color = "blue") + scale_y_continuous(name = "2016 Gross Wages",labels = label_number(suffix = "k", scale = 1e-4)) +
  theme(axis.text.x = element_text(angle = 90)) + stat_summary(fun = mean, geom = "point", color = "red")
i + geom_violin() + scale_y_continuous(name = "2016 Gross Wages",labels = label_number(suffix = "k", scale = 1e-4)) +
  theme(axis.text.x = element_text(angle = 90)) + stat_summary(fun = mean, geom = "point", color = "red")

j <- ggplot(data = df_2017, mapping = aes(x = Location, y = X2017.Gross))
j + geom_boxplot(outlier.color = "blue") +  scale_y_continuous(name = "2017 Gross Wages",labels = label_number(suffix = "k", scale = 1e-4)) +
  theme(axis.text.x = element_text(angle = 90)) + stat_summary(fun = mean, geom = "point", color = "red")
j + geom_violin() +  scale_y_continuous(name = "2017 Gross Wages",labels = label_number(suffix = "k", scale = 1e-4)) +
  theme(axis.text.x = element_text(angle = 90)) + stat_summary(fun = mean, geom = "point", color = "red")

k <- ggplot(data = df_2018, mapping = aes(x = Location, y = X2018.Gross))
k + geom_boxplot(outlier.color = "blue") +  scale_y_continuous(name = "2018 Gross Wages",labels = label_number(suffix = "k", scale = 1e-4)) +
  theme(axis.text.x = element_text(angle = 90)) + stat_summary(fun = mean, geom = "point", color = "red")
k + geom_violin() +  scale_y_continuous(name = "2018 Gross Wages",labels = label_number(suffix = "k", scale = 1e-4)) +
  theme(axis.text.x = element_text(angle = 90)) + stat_summary(fun = mean, geom = "point", color = "red")

l <- ggplot(data = df_2019, mapping = aes(x = Location, y = X2019.Gross))
l + geom_boxplot(outlier.color = "blue") +  scale_y_continuous(name = "2019 Gross Wages",labels = label_number(suffix = "k", scale = 1e-4)) +
  theme(axis.text.x = element_text(angle = 90)) + stat_summary(fun = mean, geom = "point", color = "red")
l + geom_violin() +  scale_y_continuous(name = "2019 Gross Wages",labels = label_number(suffix = "k", scale = 1e-4)) +
  theme(axis.text.x = element_text(angle = 90)) + stat_summary(fun = mean, geom = "point", color = "red")

m <- ggplot(data = df_2020, mapping = aes(x = Location, y = X2020.Gross))
m + geom_boxplot(outlier.color = "blue") +  scale_y_continuous(name = "2020 Gross Wages",labels = label_number(suffix = "k", scale = 1e-2)) +
  theme(axis.text.x = element_text(angle = 90)) + stat_summary(fun = mean, geom = "point", color = "red")
m + geom_violin() +  scale_y_continuous(name = "2020 Gross Wages",labels = label_number(suffix = "k", scale = 1e-2)) +
  theme(axis.text.x = element_text(angle = 90)) + stat_summary(fun = mean, geom = "point", color = "red")

```

That brought about some changes in the violin plots, although not so much in the boxplots. So let's break down the data by position and location see if the mean pay per position title can tell us anything. We're also going to use this chance to calculate the average percent of change between each years wages, across all the years, as well as what each wage should have risen to each year factoring in inflation by year in California. And finally, we'll use 2015 as the base year, and note down what gross pay should have been in 2020 using overall inflation in the state of California.. We'll do the same for all locations, but we won't list that code here. It's largely just copied off this batch below.
```{r split and calculate}
UCOP15 <- subset(df_2015, Location == "UCOP")
UCOP16 <- subset(df_2016, Location == "UCOP")
UCOP17 <- subset(df_2017, Location == "UCOP")
UCOP18 <- subset(df_2018, Location == "UCOP")
UCOP19 <- subset(df_2019, Location == "UCOP")
UCOP20 <- subset(df_2020, Location == "UCOP")


UCOP_titles_2015 <- UCOP15 %>%
  group_by(Title) %>%
  summarize(count15 = n(), Mean.Gross.15 = mean(X2015.Gross))

UCOP_titles_2016 <- UCOP16 %>%
  group_by(Title) %>%
  summarize(count16 = n(), Mean.Gross.16 =  mean(X2016.Gross))

UCOP_titles_2017 <- UCOP17 %>%
  group_by(Title) %>%
  summarize(count17 = n(), Mean.Gross.17 =  mean(X2017.Gross))

UCOP_titles_2018 <- UCOP18 %>%
  group_by(Title) %>%
  summarize(count18 = n(), Mean.Gross.18 =  mean(X2018.Gross))

UCOP_titles_2019 <- UCOP19 %>%
  group_by(Title) %>%
  summarize(count19 = n(), Mean.Gross.19 =  mean(X2019.Gross))

UCOP_titles_2020 <- UCOP20 %>%
  group_by(Title) %>%
  summarize(count20 = n(), Mean.Gross.20 =  mean(X2020.Gross))

UCOP1516 <- inner_join(UCOP_titles_2015, UCOP_titles_2016, by = "Title")
UCOP1718 <- inner_join(UCOP_titles_2017, UCOP_titles_2018, by = "Title")
UCOP1920 <- inner_join(UCOP_titles_2019, UCOP_titles_2020, by = "Title")
UCOP5678 <- inner_join(UCOP1516, UCOP1718, by = "Title")
UCOP <- inner_join(UCOP5678, UCOP1920, by = "Title")


UCOP <- mutate(UCOP,
       Difference.15.16 = Mean.Gross.16 - Mean.Gross.15,
       Difference.16.17 = Mean.Gross.17 - Mean.Gross.16,
       Difference.17.18 = Mean.Gross.18 - Mean.Gross.17,
       Difference.18.19 = Mean.Gross.19 - Mean.Gross.18,
       Difference.19.20 = Mean.Gross.20 - Mean.Gross.19,
       Percent.15.16 = Difference.15.16 / Mean.Gross.15 * 100,
       Percent.16.17 = Difference.16.17 / Mean.Gross.16 * 100,
       Percent.17.18 = Difference.17.18 / Mean.Gross.17 * 100,
       Percent.18.19 = Difference.18.19 / Mean.Gross.18 * 100,
       Percent.19.20 = Difference.19.20 / Mean.Gross.19 * 100)
       
UCOP$Average.Percent.Change <-  rowMeans(subset(UCOP, select = c(Percent.15.16, Percent.16.17, Percent.17.18, Percent.18.19, Percent.19.20)))

summary(UCOP$Average.Percent.Change)

#To see what inflation suggests the new wages should be, I used the CA dept. of Finance CPI Table.
UCOP <- mutate(UCOP,
               Inflation.Calculation.15.16 = (Mean.Gross.15 + (Mean.Gross.15 * 0.023)),
               Inflation.Calculation.16.17 = (Inflation.Calculation.15.16 + (Inflation.Calculation.15.16 * 0.023)),
               Inflation.Calculation.17.18 = (Inflation.Calculation.16.17 + (Inflation.Calculation.16.17 * 0.029)),
               Inflation.Calculation.18.19 = (Inflation.Calculation.17.18 + (Inflation.Calculation.17.18 * 0.037)),
               Inflation.Calculation.19.20 = (Inflation.Calculation.18.19 + (Inflation.Calculation.18.19 * 0.03)))

UCOP$Inflated.20 <- UCOP$Mean.Gross.15 + (UCOP$Mean.Gross.15 * .1038223)

```

```{r echo = FALSE}

SF15 <- subset(df_2015, Location == "San Francisco")
SF16 <- subset(df_2016, Location == "San Francisco")
SF17 <- subset(df_2017, Location == "San Francisco")
SF18 <- subset(df_2018, Location == "San Francisco")
SF19 <- subset(df_2019, Location == "San Francisco")
SF20 <- subset(df_2020, Location == "San Francisco")

SF_titles_2015 <- SF15 %>%
  group_by(Title) %>%
  summarize(count15 = n(), Mean.Gross.15 = mean(X2015.Gross))

SF_titles_2016 <- SF16 %>%
  group_by(Title) %>%
  summarize(count16 = n(), Mean.Gross.16 =  mean(X2016.Gross))

SF_titles_2017 <- SF17 %>%
  group_by(Title) %>%
  summarize(count17 = n(), Mean.Gross.17 =  mean(X2017.Gross))

SF_titles_2018 <- SF18 %>%
  group_by(Title) %>%
  summarize(count18 = n(), Mean.Gross.18 =  mean(X2018.Gross))

SF_titles_2019 <- SF19 %>%
  group_by(Title) %>%
  summarize(count19 = n(), Mean.Gross.19 =  mean(X2019.Gross))

SF_titles_2020 <- SF20 %>%
  group_by(Title) %>%
  summarize(count20 = n(), Mean.Gross.20 =  mean(X2020.Gross))

SF1516 <- inner_join(SF_titles_2015, SF_titles_2016, by = "Title")
SF1718 <- inner_join(SF_titles_2017, SF_titles_2018, by = "Title")
SF1920 <- inner_join(SF_titles_2019, SF_titles_2020, by = "Title")
SF5678 <- inner_join(SF1516, SF1718, by = "Title")
SF <- inner_join(SF5678, SF1920, by = "Title")


SF <- mutate(SF,
               Difference.15.16 = Mean.Gross.16 - Mean.Gross.15,
               Difference.16.17 = Mean.Gross.17 - Mean.Gross.16,
               Difference.17.18 = Mean.Gross.18 - Mean.Gross.17,
               Difference.18.19 = Mean.Gross.19 - Mean.Gross.18,
               Difference.19.20 = Mean.Gross.20 - Mean.Gross.19,
               Percent.15.16 = Difference.15.16 / Mean.Gross.15 * 100,
               Percent.16.17 = Difference.16.17 / Mean.Gross.16 * 100,
               Percent.17.18 = Difference.17.18 / Mean.Gross.17 * 100,
               Percent.18.19 = Difference.18.19 / Mean.Gross.18 * 100,
               Percent.19.20 = Difference.19.20 / Mean.Gross.19 * 100)
SF$Average.Percent.Change <-  rowMeans(subset(SF, select = c(Percent.15.16, Percent.16.17, Percent.17.18, Percent.18.19, Percent.19.20)))


summary(SF$Average.Percent.Change)

SF <- mutate(SF,
               Inflation.Calculation.15.16 = (Mean.Gross.15 + (Mean.Gross.15 * 0.023)),
               Inflation.Calculation.16.17 = (Inflation.Calculation.15.16 + (Inflation.Calculation.15.16 * 0.023)),
               Inflation.Calculation.17.18 = (Inflation.Calculation.16.17 + (Inflation.Calculation.16.17 * 0.029)),
               Inflation.Calculation.18.19 = (Inflation.Calculation.17.18 + (Inflation.Calculation.17.18 * 0.037)),
               Inflation.Calculation.19.20 = (Inflation.Calculation.18.19 + (Inflation.Calculation.18.19 * 0.03)))

SF$Inflated.20 <- SF$Mean.Gross.15 + (SF$Mean.Gross.15 * .1038223)

Berkeley15 <- subset(df_2015, Location == "Berkeley")
Berkeley16 <- subset(df_2016, Location == "Berkeley")
Berkeley17 <- subset(df_2017, Location == "Berkeley")
Berkeley18 <- subset(df_2018, Location == "Berkeley")
Berkeley19 <- subset(df_2019, Location == "Berkeley")
Berkeley20 <- subset(df_2020, Location == "Berkeley")


Berkeley_titles_2015 <- Berkeley15 %>%
  group_by(Title) %>%
  summarize(count15 = n(), Mean.Gross.15 = mean(X2015.Gross))

Berkeley_titles_2016 <- Berkeley16 %>%
  group_by(Title) %>%
  summarize(count16 = n(), Mean.Gross.16 =  mean(X2016.Gross))

Berkeley_titles_2017 <- Berkeley17 %>%
  group_by(Title) %>%
  summarize(count17 = n(), Mean.Gross.17 =  mean(X2017.Gross))

Berkeley_titles_2018 <- Berkeley18 %>%
  group_by(Title) %>%
  summarize(count18 = n(), Mean.Gross.18 =  mean(X2018.Gross))

Berkeley_titles_2019 <- Berkeley19 %>%
  group_by(Title) %>%
  summarize(count19 = n(), Mean.Gross.19 =  mean(X2019.Gross))

Berkeley_titles_2020 <- Berkeley20 %>%
  group_by(Title) %>%
  summarize(count20 = n(), Mean.Gross.20 =  mean(X2020.Gross))

Berkeley1516 <- inner_join(Berkeley_titles_2015, Berkeley_titles_2016, by = "Title")
Berkeley1718 <- inner_join(Berkeley_titles_2017, Berkeley_titles_2018, by = "Title")
Berkeley1920 <- inner_join(Berkeley_titles_2019, Berkeley_titles_2020, by = "Title")
Berkeley5678 <- inner_join(Berkeley1516, Berkeley1718, by = "Title")
Berkeley <- inner_join(Berkeley5678, Berkeley1920, by = "Title")

Berkeley <- mutate(Berkeley,
               Difference.15.16 = Mean.Gross.16 - Mean.Gross.15,
               Difference.16.17 = Mean.Gross.17 - Mean.Gross.16,
               Difference.17.18 = Mean.Gross.18 - Mean.Gross.17,
               Difference.18.19 = Mean.Gross.19 - Mean.Gross.18,
               Difference.19.20 = Mean.Gross.20 - Mean.Gross.19,
               Percent.15.16 = Difference.15.16 / Mean.Gross.15 * 100,
               Percent.16.17 = Difference.16.17 / Mean.Gross.16 * 100,
               Percent.17.18 = Difference.17.18 / Mean.Gross.17 * 100,
               Percent.18.19 = Difference.18.19 / Mean.Gross.18 * 100,
               Percent.19.20 = Difference.19.20 / Mean.Gross.19 * 100)
Berkeley$Average.Percent.Change <-  rowMeans(subset(Berkeley, select = c(Percent.15.16, Percent.16.17, Percent.17.18, Percent.18.19,
                                                                         Percent.19.20)))

summary(Berkeley$Average.Percent.Change)

#To see what inflation suggests the new wages should be, I used the CA dept. of Finance CPI Table.
Berkeley <- mutate(Berkeley,
               Inflation.Calculation.15.16 = (Mean.Gross.15 + (Mean.Gross.15 * 0.023)),
               Inflation.Calculation.16.17 = (Inflation.Calculation.15.16 + (Inflation.Calculation.15.16 * 0.023)),
               Inflation.Calculation.17.18 = (Inflation.Calculation.16.17 + (Inflation.Calculation.16.17 * 0.029)),
               Inflation.Calculation.18.19 = (Inflation.Calculation.17.18 + (Inflation.Calculation.17.18 * 0.037)),
               Inflation.Calculation.19.20 = (Inflation.Calculation.18.19 + (Inflation.Calculation.18.19 * 0.03)))

Berkeley$Inflated.20 <- Berkeley$Mean.Gross.15 + (Berkeley$Mean.Gross.15 * .1038223)

Davis15 <- subset(df_2015, Location == "Davis")
Davis16 <- subset(df_2016, Location == "Davis")
Davis17 <- subset(df_2017, Location == "Davis")
Davis18 <- subset(df_2018, Location == "Davis")
Davis19 <- subset(df_2019, Location == "Davis")
Davis20 <- subset(df_2020, Location == "Davis")


Davis_titles_2015 <- Davis15 %>%
  group_by(Title) %>%
  summarize(count15 = n(), Mean.Gross.15 = mean(X2015.Gross))

Davis_titles_2016 <- Davis16 %>%
  group_by(Title) %>%
  summarize(count16 = n(), Mean.Gross.16 =  mean(X2016.Gross))

Davis_titles_2017 <- Davis17 %>%
  group_by(Title) %>%
  summarize(count17 = n(), Mean.Gross.17 =  mean(X2017.Gross))

Davis_titles_2018 <- Davis18 %>%
  group_by(Title) %>%
  summarize(count18 = n(), Mean.Gross.18 =  mean(X2018.Gross))

Davis_titles_2019 <- Davis19 %>%
  group_by(Title) %>%
  summarize(count19 = n(), Mean.Gross.19 =  mean(X2019.Gross))

Davis_titles_2020 <- Davis20 %>%
  group_by(Title) %>%
  summarize(count20 = n(), Mean.Gross.20 =  mean(X2020.Gross))

Davis1516 <- inner_join(Davis_titles_2015, Davis_titles_2016, by = "Title")
Davis1718 <- inner_join(Davis_titles_2017, Davis_titles_2018, by = "Title")
Davis1920 <- inner_join(Davis_titles_2019, Davis_titles_2020, by = "Title")
Davis5678 <- inner_join(Davis1516, Davis1718, by = "Title")
Davis <- inner_join(Davis5678, Davis1920, by = "Title")


Davis <- mutate(Davis,
               Difference.15.16 = Mean.Gross.16 - Mean.Gross.15,
               Difference.16.17 = Mean.Gross.17 - Mean.Gross.16,
               Difference.17.18 = Mean.Gross.18 - Mean.Gross.17,
               Difference.18.19 = Mean.Gross.19 - Mean.Gross.18,
               Difference.19.20 = Mean.Gross.20 - Mean.Gross.19,
               Percent.15.16 = Difference.15.16 / Mean.Gross.15 * 100,
               Percent.16.17 = Difference.16.17 / Mean.Gross.16 * 100,
               Percent.17.18 = Difference.17.18 / Mean.Gross.17 * 100,
               Percent.18.19 = Difference.18.19 / Mean.Gross.18 * 100,
               Percent.19.20 = Difference.19.20 / Mean.Gross.19 * 100)
Davis$Average.Percent.Change <-  rowMeans(subset(Davis, select = c(Percent.15.16, Percent.16.17, Percent.17.18, Percent.18.19, Percent.19.20)))

summary(Davis$Average.Percent.Change)

#To see what inflation suggests the new wages should be, I used the CA dept. of Finance CPI Table.
Davis <- mutate(Davis,
               Inflation.Calculation.15.16 = (Mean.Gross.15 + (Mean.Gross.15 * 0.023)),
               Inflation.Calculation.16.17 = (Inflation.Calculation.15.16 + (Inflation.Calculation.15.16 * 0.023)),
               Inflation.Calculation.17.18 = (Inflation.Calculation.16.17 + (Inflation.Calculation.16.17 * 0.029)),
               Inflation.Calculation.18.19 = (Inflation.Calculation.17.18 + (Inflation.Calculation.17.18 * 0.037)),
               Inflation.Calculation.19.20 = (Inflation.Calculation.18.19 + (Inflation.Calculation.18.19 * 0.03)))

Davis$Inflated.20 <- Davis$Mean.Gross.15 + (Davis$Mean.Gross.15 * .1038223)

Irvine15 <- subset(df_2015, Location == "Irvine")
Irvine16 <- subset(df_2016, Location == "Irvine")
Irvine17 <- subset(df_2017, Location == "Irvine")
Irvine18 <- subset(df_2018, Location == "Irvine")
Irvine19 <- subset(df_2019, Location == "Irvine")
Irvine20 <- subset(df_2020, Location == "Irvine")


Irvine_titles_2015 <- Irvine15 %>%
  group_by(Title) %>%
  summarize(count15 = n(), Mean.Gross.15 = mean(X2015.Gross))

Irvine_titles_2016 <- Irvine16 %>%
  group_by(Title) %>%
  summarize(count16 = n(), Mean.Gross.16 =  mean(X2016.Gross))

Irvine_titles_2017 <- Irvine17 %>%
  group_by(Title) %>%
  summarize(count17 = n(), Mean.Gross.17 =  mean(X2017.Gross))

Irvine_titles_2018 <- Irvine18 %>%
  group_by(Title) %>%
  summarize(count18 = n(), Mean.Gross.18 =  mean(X2018.Gross))

Irvine_titles_2019 <- Irvine19 %>%
  group_by(Title) %>%
  summarize(count19 = n(), Mean.Gross.19 =  mean(X2019.Gross))

Irvine_titles_2020 <- Irvine20 %>%
  group_by(Title) %>%
  summarize(count20 = n(), Mean.Gross.20 =  mean(X2020.Gross))

Irvine1516 <- inner_join(Irvine_titles_2015, Irvine_titles_2016, by = "Title")
Irvine1718 <- inner_join(Irvine_titles_2017, Irvine_titles_2018, by = "Title")
Irvine1920 <- inner_join(Irvine_titles_2019, Irvine_titles_2020, by = "Title")
Irvine5678 <- inner_join(Irvine1516, Irvine1718, by = "Title")
Irvine <- inner_join(Irvine5678, Irvine1920, by = "Title")


Irvine <- mutate(Irvine,
               Difference.15.16 = Mean.Gross.16 - Mean.Gross.15,
               Difference.16.17 = Mean.Gross.17 - Mean.Gross.16,
               Difference.17.18 = Mean.Gross.18 - Mean.Gross.17,
               Difference.18.19 = Mean.Gross.19 - Mean.Gross.18,
               Difference.19.20 = Mean.Gross.20 - Mean.Gross.19,
               Percent.15.16 = Difference.15.16 / Mean.Gross.15 * 100,
               Percent.16.17 = Difference.16.17 / Mean.Gross.16 * 100,
               Percent.17.18 = Difference.17.18 / Mean.Gross.17 * 100,
               Percent.18.19 = Difference.18.19 / Mean.Gross.18 * 100,
               Percent.19.20 = Difference.19.20 / Mean.Gross.19 * 100)
Irvine$Average.Percent.Change <-  rowMeans(subset(Irvine, select = c(Percent.15.16, Percent.16.17, Percent.17.18, Percent.18.19,
                                                                     Percent.19.20)))

summary(Irvine$Average.Percent.Change)

#To see what inflation suggests the new wages should be, I used the CA dept. of Finance CPI Table.
Irvine <- mutate(Irvine,
               Inflation.Calculation.15.16 = (Mean.Gross.15 + (Mean.Gross.15 * 0.023)),
               Inflation.Calculation.16.17 = (Inflation.Calculation.15.16 + (Inflation.Calculation.15.16 * 0.023)),
               Inflation.Calculation.17.18 = (Inflation.Calculation.16.17 + (Inflation.Calculation.16.17 * 0.029)),
               Inflation.Calculation.18.19 = (Inflation.Calculation.17.18 + (Inflation.Calculation.17.18 * 0.037)),
               Inflation.Calculation.19.20 = (Inflation.Calculation.18.19 + (Inflation.Calculation.18.19 * 0.03)))

Irvine$Inflated.20 <- Irvine$Mean.Gross.15 + (Irvine$Mean.Gross.15 * .1038223)

Los_Angeles15 <- subset(df_2015, Location == "Los Angeles")
Los_Angeles16 <- subset(df_2016, Location == "Los Angeles")
Los_Angeles17 <- subset(df_2017, Location == "Los Angeles")
Los_Angeles18 <- subset(df_2018, Location == "Los Angeles")
Los_Angeles19 <- subset(df_2019, Location == "Los Angeles")
Los_Angeles20 <- subset(df_2020, Location == "Los Angeles")


Los_Angeles_titles_2015 <- Los_Angeles15 %>%
  group_by(Title) %>%
  summarize(count15 = n(), Mean.Gross.15 = mean(X2015.Gross))

Los_Angeles_titles_2016 <- Los_Angeles16 %>%
  group_by(Title) %>%
  summarize(count16 = n(), Mean.Gross.16 =  mean(X2016.Gross))

Los_Angeles_titles_2017 <- Los_Angeles17 %>%
  group_by(Title) %>%
  summarize(count17 = n(), Mean.Gross.17 =  mean(X2017.Gross))

Los_Angeles_titles_2018 <- Los_Angeles18 %>%
  group_by(Title) %>%
  summarize(count18 = n(), Mean.Gross.18 =  mean(X2018.Gross))

Los_Angeles_titles_2019 <- Los_Angeles19 %>%
  group_by(Title) %>%
  summarize(count19 = n(), Mean.Gross.19 =  mean(X2019.Gross))

Los_Angeles_titles_2020 <- Los_Angeles20 %>%
  group_by(Title) %>%
  summarize(count20 = n(), Mean.Gross.20 =  mean(X2020.Gross))

Los_Angeles1516 <- inner_join(Los_Angeles_titles_2015, Los_Angeles_titles_2016, by = "Title")
Los_Angeles1718 <- inner_join(Los_Angeles_titles_2017, Los_Angeles_titles_2018, by = "Title")
Los_Angeles1920 <- inner_join(Los_Angeles_titles_2019, Los_Angeles_titles_2020, by = "Title")
Los_Angeles5678 <- inner_join(Los_Angeles1516, Los_Angeles1718, by = "Title")
Los_Angeles <- inner_join(Los_Angeles5678, Los_Angeles1920, by = "Title")

Los_Angeles <- mutate(Los_Angeles,
               Difference.15.16 = Mean.Gross.16 - Mean.Gross.15,
               Difference.16.17 = Mean.Gross.17 - Mean.Gross.16,
               Difference.17.18 = Mean.Gross.18 - Mean.Gross.17,
               Difference.18.19 = Mean.Gross.19 - Mean.Gross.18,
               Difference.19.20 = Mean.Gross.20 - Mean.Gross.19,
               Percent.15.16 = Difference.15.16 / Mean.Gross.15 * 100,
               Percent.16.17 = Difference.16.17 / Mean.Gross.16 * 100,
               Percent.17.18 = Difference.17.18 / Mean.Gross.17 * 100,
               Percent.18.19 = Difference.18.19 / Mean.Gross.18 * 100,
               Percent.19.20 = Difference.19.20 / Mean.Gross.19 * 100)
Los_Angeles$Average.Percent.Change <- rowMeans(subset(Los_Angeles,select = c(Percent.15.16, Percent.16.17, Percent.17.18, Percent.18.19,
                                                                             Percent.19.20)))

summary(Los_Angeles$Average.Percent.Change)

#To see what inflation suggests the new wages should be, I used the CA dept. of Finance CPI Table.
Los_Angeles <- mutate(Los_Angeles,
               Inflation.Calculation.15.16 = (Mean.Gross.15 + (Mean.Gross.15 * 0.023)),
               Inflation.Calculation.16.17 = (Inflation.Calculation.15.16 + (Inflation.Calculation.15.16 * 0.023)),
               Inflation.Calculation.17.18 = (Inflation.Calculation.16.17 + (Inflation.Calculation.16.17 * 0.029)),
               Inflation.Calculation.18.19 = (Inflation.Calculation.17.18 + (Inflation.Calculation.17.18 * 0.037)),
               Inflation.Calculation.19.20 = (Inflation.Calculation.18.19 + (Inflation.Calculation.18.19 * 0.03)))

Los_Angeles$Inflated.20 <- Los_Angeles$Mean.Gross.15 + (Los_Angeles$Mean.Gross.15 * .1038223)

Merced15 <- subset(df_2015, Location == "Merced")
Merced16 <- subset(df_2016, Location == "Merced")
Merced17 <- subset(df_2017, Location == "Merced")
Merced18 <- subset(df_2018, Location == "Merced")
Merced19 <- subset(df_2019, Location == "Merced")
Merced20 <- subset(df_2020, Location == "Merced")


Merced_titles_2015 <- Merced15 %>%
  group_by(Title) %>%
  summarize(count15 = n(), Mean.Gross.15 = mean(X2015.Gross))

Merced_titles_2016 <- Merced16 %>%
  group_by(Title) %>%
  summarize(count16 = n(), Mean.Gross.16 =  mean(X2016.Gross))

Merced_titles_2017 <- Merced17 %>%
  group_by(Title) %>%
  summarize(count17 = n(), Mean.Gross.17 =  mean(X2017.Gross))

Merced_titles_2018 <- Merced18 %>%
  group_by(Title) %>%
  summarize(count18 = n(), Mean.Gross.18 =  mean(X2018.Gross))

Merced_titles_2019 <- Merced19 %>%
  group_by(Title) %>%
  summarize(count19 = n(), Mean.Gross.19 =  mean(X2019.Gross))

Merced_titles_2020 <- Merced20 %>%
  group_by(Title) %>%
  summarize(count20 = n(), Mean.Gross.20 =  mean(X2020.Gross))

Merced1516 <- inner_join(Merced_titles_2015, Merced_titles_2016, by = "Title")
Merced1718 <- inner_join(Merced_titles_2017, Merced_titles_2018, by = "Title")
Merced1920 <- inner_join(Merced_titles_2019, Merced_titles_2020, by = "Title")
Merced5678 <- inner_join(Merced1516, Merced1718, by = "Title")
Merced <- inner_join(Merced5678, Merced1920, by = "Title")


Merced <- mutate(Merced,
               Difference.15.16 = Mean.Gross.16 - Mean.Gross.15,
               Difference.16.17 = Mean.Gross.17 - Mean.Gross.16,
               Difference.17.18 = Mean.Gross.18 - Mean.Gross.17,
               Difference.18.19 = Mean.Gross.19 - Mean.Gross.18,
               Difference.19.20 = Mean.Gross.20 - Mean.Gross.19,
               Percent.15.16 = Difference.15.16 / Mean.Gross.15 * 100,
               Percent.16.17 = Difference.16.17 / Mean.Gross.16 * 100,
               Percent.17.18 = Difference.17.18 / Mean.Gross.17 * 100,
               Percent.18.19 = Difference.18.19 / Mean.Gross.18 * 100,
               Percent.19.20 = Difference.19.20 / Mean.Gross.19 * 100)
Merced$Average.Percent.Change <-  rowMeans(subset(Merced, select = c(Percent.15.16, Percent.16.17, Percent.17.18, Percent.18.19,
                                                                     Percent.19.20)))

summary(Merced$Average.Percent.Change)

#To see what inflation suggests the new wages should be, I used the CA dept. of Finance CPI Table.
Merced <- mutate(Merced,
               Inflation.Calculation.15.16 = (Mean.Gross.15 + (Mean.Gross.15 * 0.023)),
               Inflation.Calculation.16.17 = (Inflation.Calculation.15.16 + (Inflation.Calculation.15.16 * 0.023)),
               Inflation.Calculation.17.18 = (Inflation.Calculation.16.17 + (Inflation.Calculation.16.17 * 0.029)),
               Inflation.Calculation.18.19 = (Inflation.Calculation.17.18 + (Inflation.Calculation.17.18 * 0.037)),
               Inflation.Calculation.19.20 = (Inflation.Calculation.18.19 + (Inflation.Calculation.18.19 * 0.03)))

Merced$Inflated.20 <- Merced$Mean.Gross.15 + (Merced$Mean.Gross.15 * .1038223)

Riverside15 <- subset(df_2015, Location == "Riverside")
Riverside16 <- subset(df_2016, Location == "Riverside")
Riverside17 <- subset(df_2017, Location == "Riverside")
Riverside18 <- subset(df_2018, Location == "Riverside")
Riverside19 <- subset(df_2019, Location == "Riverside")
Riverside20 <- subset(df_2020, Location == "Riverside")


Riverside_titles_2015 <- Riverside15 %>%
  group_by(Title) %>%
  summarize(count15 = n(), Mean.Gross.15 = mean(X2015.Gross))

Riverside_titles_2016 <- Riverside16 %>%
  group_by(Title) %>%
  summarize(count16 = n(), Mean.Gross.16 =  mean(X2016.Gross))

Riverside_titles_2017 <- Riverside17 %>%
  group_by(Title) %>%
  summarize(count17 = n(), Mean.Gross.17 =  mean(X2017.Gross))

Riverside_titles_2018 <- Riverside18 %>%
  group_by(Title) %>%
  summarize(count18 = n(), Mean.Gross.18 =  mean(X2018.Gross))

Riverside_titles_2019 <- Riverside19 %>%
  group_by(Title) %>%
  summarize(count19 = n(), Mean.Gross.19 =  mean(X2019.Gross))

Riverside_titles_2020 <- Riverside20 %>%
  group_by(Title) %>%
  summarize(count20 = n(), Mean.Gross.20 =  mean(X2020.Gross))

Riverside1516 <- inner_join(Riverside_titles_2015, Riverside_titles_2016, by = "Title")
Riverside1718 <- inner_join(Riverside_titles_2017, Riverside_titles_2018, by = "Title")
Riverside1920 <- inner_join(Riverside_titles_2019, Riverside_titles_2020, by = "Title")
Riverside5678 <- inner_join(Riverside1516, Riverside1718, by = "Title")
Riverside <- inner_join(Riverside5678, Riverside1920, by = "Title")


Riverside <- mutate(Riverside,
               Difference.15.16 = Mean.Gross.16 - Mean.Gross.15,
               Difference.16.17 = Mean.Gross.17 - Mean.Gross.16,
               Difference.17.18 = Mean.Gross.18 - Mean.Gross.17,
               Difference.18.19 = Mean.Gross.19 - Mean.Gross.18,
               Difference.19.20 = Mean.Gross.20 - Mean.Gross.19,
               Percent.15.16 = Difference.15.16 / Mean.Gross.15 * 100,
               Percent.16.17 = Difference.16.17 / Mean.Gross.16 * 100,
               Percent.17.18 = Difference.17.18 / Mean.Gross.17 * 100,
               Percent.18.19 = Difference.18.19 / Mean.Gross.18 * 100,
               Percent.19.20 = Difference.19.20 / Mean.Gross.19 * 100)
Riverside$Average.Percent.Change <-  rowMeans(subset(Riverside, select = c(Percent.15.16, Percent.16.17, Percent.17.18, Percent.18.19,
                                                                           Percent.19.20)))

summary(Riverside$Average.Percent.Change)

#To see what inflation suggests the new wages should be, I used the CA dept. of Finance CPI Table.
Riverside <- mutate(Riverside,
               Inflation.Calculation.15.16 = (Mean.Gross.15 + (Mean.Gross.15 * 0.023)),
               Inflation.Calculation.16.17 = (Inflation.Calculation.15.16 + (Inflation.Calculation.15.16 * 0.023)),
               Inflation.Calculation.17.18 = (Inflation.Calculation.16.17 + (Inflation.Calculation.16.17 * 0.029)),
               Inflation.Calculation.18.19 = (Inflation.Calculation.17.18 + (Inflation.Calculation.17.18 * 0.037)),
               Inflation.Calculation.19.20 = (Inflation.Calculation.18.19 + (Inflation.Calculation.18.19 * 0.03)))

Riverside$Inflated.20 <- Riverside$Mean.Gross.15 + (Riverside$Mean.Gross.15 * .1038223)

San_Diego15 <- subset(df_2015, Location == "San Diego")
San_Diego16 <- subset(df_2016, Location == "San Diego")
San_Diego17 <- subset(df_2017, Location == "San Diego")
San_Diego18 <- subset(df_2018, Location == "San Diego")
San_Diego19 <- subset(df_2019, Location == "San Diego")
San_Diego20 <- subset(df_2020, Location == "San Diego")

San_Diego_titles_2015 <- San_Diego15 %>%
  group_by(Title) %>%
  summarize(count15 = n(), Mean.Gross.15 = mean(X2015.Gross))

San_Diego_titles_2016 <- San_Diego16 %>%
  group_by(Title) %>%
  summarize(count16 = n(), Mean.Gross.16 =  mean(X2016.Gross))

San_Diego_titles_2017 <- San_Diego17 %>%
  group_by(Title) %>%
  summarize(count17 = n(), Mean.Gross.17 =  mean(X2017.Gross))

San_Diego_titles_2018 <- San_Diego18 %>%
  group_by(Title) %>%
  summarize(count18 = n(), Mean.Gross.18 =  mean(X2018.Gross))

San_Diego_titles_2019 <- San_Diego19 %>%
  group_by(Title) %>%
  summarize(count19 = n(), Mean.Gross.19 =  mean(X2019.Gross))

San_Diego_titles_2020 <- San_Diego20 %>%
  group_by(Title) %>%
  summarize(count20 = n(), Mean.Gross.20 =  mean(X2020.Gross))

San_Diego1516 <- inner_join(San_Diego_titles_2015, San_Diego_titles_2016, by = "Title")
San_Diego1718 <- inner_join(San_Diego_titles_2017, San_Diego_titles_2018, by = "Title")
San_Diego1920 <- inner_join(San_Diego_titles_2019, San_Diego_titles_2020, by = "Title")
San_Diego5678 <- inner_join(San_Diego1516, San_Diego1718, by = "Title")
San_Diego <- inner_join(San_Diego5678, San_Diego1920, by = "Title")

San_Diego <- mutate(San_Diego,
               Difference.15.16 = Mean.Gross.16 - Mean.Gross.15,
               Difference.16.17 = Mean.Gross.17 - Mean.Gross.16,
               Difference.17.18 = Mean.Gross.18 - Mean.Gross.17,
               Difference.18.19 = Mean.Gross.19 - Mean.Gross.18,
               Difference.19.20 = Mean.Gross.20 - Mean.Gross.19,
               Percent.15.16 = Difference.15.16 / Mean.Gross.15 * 100,
               Percent.16.17 = Difference.16.17 / Mean.Gross.16 * 100,
               Percent.17.18 = Difference.17.18 / Mean.Gross.17 * 100,
               Percent.18.19 = Difference.18.19 / Mean.Gross.18 * 100,
               Percent.19.20 = Difference.19.20 / Mean.Gross.19 * 100)
San_Diego$Average.Percent.Change <- rowMeans(subset(San_Diego, select = c(Percent.15.16, Percent.16.17, Percent.17.18, Percent.18.19,
                                                                          Percent.19.20)))

summary(San_Diego$Average.Percent.Change)

#To see what inflation suggests the new wages should be, I used the CA dept. of Finance CPI Table.
San_Diego <- mutate(San_Diego,
               Inflation.Calculation.15.16 = (Mean.Gross.15 + (Mean.Gross.15 * 0.023)),
               Inflation.Calculation.16.17 = (Inflation.Calculation.15.16 + (Inflation.Calculation.15.16 * 0.023)),
               Inflation.Calculation.17.18 = (Inflation.Calculation.16.17 + (Inflation.Calculation.16.17 * 0.029)),
               Inflation.Calculation.18.19 = (Inflation.Calculation.17.18 + (Inflation.Calculation.17.18 * 0.037)),
               Inflation.Calculation.19.20 = (Inflation.Calculation.18.19 + (Inflation.Calculation.18.19 * 0.03)))

San_Diego$Inflated.20 <- San_Diego$Mean.Gross.15 + (San_Diego$Mean.Gross.15 * .1038223)

Santa_Barbara15 <- subset(df_2015, Location == "Santa Barbara")
Santa_Barbara16 <- subset(df_2016, Location == "Santa Barbara")
Santa_Barbara17 <- subset(df_2017, Location == "Santa Barbara")
Santa_Barbara18 <- subset(df_2018, Location == "Santa Barbara")
Santa_Barbara19 <- subset(df_2019, Location == "Santa Barbara")
Santa_Barbara20 <- subset(df_2020, Location == "Santa Barbara")

Santa_Barbara_titles_2015 <- Santa_Barbara15 %>%
  group_by(Title) %>%
  summarize(count15 = n(), Mean.Gross.15 = mean(X2015.Gross))

Santa_Barbara_titles_2016 <- Santa_Barbara16 %>%
  group_by(Title) %>%
  summarize(count16 = n(), Mean.Gross.16 =  mean(X2016.Gross))

Santa_Barbara_titles_2017 <- Santa_Barbara17 %>%
  group_by(Title) %>%
  summarize(count17 = n(), Mean.Gross.17 =  mean(X2017.Gross))

Santa_Barbara_titles_2018 <- Santa_Barbara18 %>%
  group_by(Title) %>%
  summarize(count18 = n(), Mean.Gross.18 =  mean(X2018.Gross))

Santa_Barbara_titles_2019 <- Santa_Barbara19 %>%
  group_by(Title) %>%
  summarize(count19 = n(), Mean.Gross.19 =  mean(X2019.Gross))

Santa_Barbara_titles_2020 <- Santa_Barbara20 %>%
  group_by(Title) %>%
  summarize(count20 = n(), Mean.Gross.20 =  mean(X2020.Gross))

Santa_Barbara1516 <- inner_join(Santa_Barbara_titles_2015, Santa_Barbara_titles_2016, by = "Title")
Santa_Barbara1718 <- inner_join(Santa_Barbara_titles_2017, Santa_Barbara_titles_2018, by = "Title")
Santa_Barbara1920 <- inner_join(Santa_Barbara_titles_2019, Santa_Barbara_titles_2020, by = "Title")
Santa_Barbara5678 <- inner_join(Santa_Barbara1516, Santa_Barbara1718, by = "Title")
Santa_Barbara <- inner_join(Santa_Barbara5678, Santa_Barbara1920, by = "Title")


Santa_Barbara <- mutate(Santa_Barbara,
               Difference.15.16 = Mean.Gross.16 - Mean.Gross.15,
               Difference.16.17 = Mean.Gross.17 - Mean.Gross.16,
               Difference.17.18 = Mean.Gross.18 - Mean.Gross.17,
               Difference.18.19 = Mean.Gross.19 - Mean.Gross.18,
               Difference.19.20 = Mean.Gross.20 - Mean.Gross.19,
               Percent.15.16 = Difference.15.16 / Mean.Gross.15 * 100,
               Percent.16.17 = Difference.16.17 / Mean.Gross.16 * 100,
               Percent.17.18 = Difference.17.18 / Mean.Gross.17 * 100,
               Percent.18.19 = Difference.18.19 / Mean.Gross.18 * 100,
               Percent.19.20 = Difference.19.20 / Mean.Gross.19 * 100)
Santa_Barbara$Average.Percent.Change <-  rowMeans(subset(Santa_Barbara, select = c(Percent.15.16, Percent.16.17, Percent.17.18, Percent.18.19,
                                                                                   Percent.19.20)))

summary(Santa_Barbara$Average.Percent.Change)

#To see what inflation suggests the new wages should be, I used the CA dept. of Finance CPI Table.
Santa_Barbara <- mutate(Santa_Barbara,
               Inflation.Calculation.15.16 = (Mean.Gross.15 + (Mean.Gross.15 * 0.023)),
               Inflation.Calculation.16.17 = (Inflation.Calculation.15.16 + (Inflation.Calculation.15.16 * 0.023)),
               Inflation.Calculation.17.18 = (Inflation.Calculation.16.17 + (Inflation.Calculation.16.17 * 0.029)),
               Inflation.Calculation.18.19 = (Inflation.Calculation.17.18 + (Inflation.Calculation.17.18 * 0.037)),
               Inflation.Calculation.19.20 = (Inflation.Calculation.18.19 + (Inflation.Calculation.18.19 * 0.03)))

Santa_Barbara$Inflated.20 <- Santa_Barbara$Mean.Gross.15 + (Santa_Barbara$Mean.Gross.15 * .1038223)


Santa_Cruz15 <- subset(df_2015, Location == "Santa Cruz")
Santa_Cruz16 <- subset(df_2016, Location == "Santa Cruz")
Santa_Cruz17 <- subset(df_2017, Location == "Santa Cruz")
Santa_Cruz18 <- subset(df_2018, Location == "Santa Cruz")
Santa_Cruz19 <- subset(df_2019, Location == "Santa Cruz")
Santa_Cruz20 <- subset(df_2020, Location == "Santa Cruz")


Santa_Cruz_titles_2015 <- Santa_Cruz15 %>%
  group_by(Title) %>%
  summarize(count15 = n(), Mean.Gross.15 = mean(X2015.Gross))

Santa_Cruz_titles_2016 <- Santa_Cruz16 %>%
  group_by(Title) %>%
  summarize(count16 = n(), Mean.Gross.16 =  mean(X2016.Gross))

Santa_Cruz_titles_2017 <- Santa_Cruz17 %>%
  group_by(Title) %>%
  summarize(count17 = n(), Mean.Gross.17 =  mean(X2017.Gross))

Santa_Cruz_titles_2018 <- Santa_Cruz18 %>%
  group_by(Title) %>%
  summarize(count18 = n(), Mean.Gross.18 =  mean(X2018.Gross))

Santa_Cruz_titles_2019 <- Santa_Cruz19 %>%
  group_by(Title) %>%
  summarize(count19 = n(), Mean.Gross.19 =  mean(X2019.Gross))

Santa_Cruz_titles_2020 <- Santa_Cruz20 %>%
  group_by(Title) %>%
  summarize(count20 = n(), Mean.Gross.20 =  mean(X2020.Gross))

Santa_Cruz1516 <- inner_join(Santa_Cruz_titles_2015, Santa_Cruz_titles_2016, by = "Title")
Santa_Cruz1718 <- inner_join(Santa_Cruz_titles_2017, Santa_Cruz_titles_2018, by = "Title")
Santa_Cruz1920 <- inner_join(Santa_Cruz_titles_2019, Santa_Cruz_titles_2020, by = "Title")
Santa_Cruz5678 <- inner_join(Santa_Cruz1516, Santa_Cruz1718, by = "Title")
Santa_Cruz <- inner_join(Santa_Cruz5678, Santa_Cruz1920, by = "Title")

Santa_Cruz <- mutate(Santa_Cruz,
               Difference.15.16 = Mean.Gross.16 - Mean.Gross.15,
               Difference.16.17 = Mean.Gross.17 - Mean.Gross.16,
               Difference.17.18 = Mean.Gross.18 - Mean.Gross.17,
               Difference.18.19 = Mean.Gross.19 - Mean.Gross.18,
               Difference.19.20 = Mean.Gross.20 - Mean.Gross.19,
               Percent.15.16 = Difference.15.16 / Mean.Gross.15 * 100,
               Percent.16.17 = Difference.16.17 / Mean.Gross.16 * 100,
               Percent.17.18 = Difference.17.18 / Mean.Gross.17 * 100,
               Percent.18.19 = Difference.18.19 / Mean.Gross.18 * 100,
               Percent.19.20 = Difference.19.20 / Mean.Gross.19 * 100)
Santa_Cruz$Average.Percent.Change = rowMeans(subset(Santa_Cruz, select = c(Percent.15.16, Percent.16.17, Percent.17.18, Percent.18.19,
                                                                           Percent.19.20)))

summary(Santa_Cruz$Average.Percent.Change)

#To see what inflation suggests the new wages should be, I used the CA dept. of Finance CPI Table.
Santa_Cruz <- mutate(Santa_Cruz,
               Inflation.Calculation.15.16 = (Mean.Gross.15 + (Mean.Gross.15 * 0.023)),
               Inflation.Calculation.16.17 = (Inflation.Calculation.15.16 + (Inflation.Calculation.15.16 * 0.023)),
               Inflation.Calculation.17.18 = (Inflation.Calculation.16.17 + (Inflation.Calculation.16.17 * 0.029)),
               Inflation.Calculation.18.19 = (Inflation.Calculation.17.18 + (Inflation.Calculation.17.18 * 0.037)),
               Inflation.Calculation.19.20 = (Inflation.Calculation.18.19 + (Inflation.Calculation.18.19 * 0.03)))

Santa_Cruz$Inflated.20 <- Santa_Cruz$Mean.Gross.15 + (Santa_Cruz$Mean.Gross.15 * .1038223)
```
That's a lot of negative percent changes. So let's compare total inflation between 2015 and 2020. None of the chunked down data have the locaiton within them, so we'll assign that, and merge them all into one larger dataframe we can work with. Since we'll be looking at the difference betwee n2015 and 2020, we won't need to use the data from newer UC's such as Hastings.
```{r Location assignment}
Berkeley$Location <- "Berkeley"
Davis$Location <- "Davis"
Irvine$Location <- "Irvine"
Los_Angeles$Location <- "Los Angeles"
Merced$Location <-  "Merced"
Riverside$Location <- "Riverside"
San_Diego$Location <- "San Diego"
SF$Location <- "San Francisco"
Santa_Barbara$Location <- "Santa Barbara"
Santa_Cruz$Location <- "Santa Cruz"
UCOP$Location <- "UCOP"

UCWages <- do.call("rbind", list(Berkeley, Davis, Irvine, Los_Angeles, Merced, Riverside, San_Diego, SF, Santa_Barbara, Santa_Cruz, UCOP))
```

Now that that's done, lets make some fresher graphs with the data. Since there are 12 UC's, and we only want a broad overview to start, we won't use any x-axis labels, and we'll use a facet wrap to see all the data.
```{r total graphs}
colors <- c("2020 Mean Gross" = "red", "2020 Inflation Adjusted" = "green")

t <- ggplot(UCWages, mapping = aes(x = Title))
t + geom_point(mapping = aes(y = Mean.Gross.20, color = "2020 Mean Gross")) + 
  geom_point(mapping = aes(y = Inflated.20, color = "2020 Inflation Adjusted")) +
  facet_wrap(~Location) + scale_y_continuous(name = "Mean Wages",labels = label_number(suffix = "k", scale = 1e-3)) +
  theme(axis.text.x = element_blank(), legend.position = "bottom") + xlab("Position")
```
That is not great to see. The difference between mean gross pay and what it should be when adjusted for inflation over just 5 years is a lot more distinct than I would have liked. So lets look at some closer examples. Merced has a fairly small sample size, so we'll look at that graph in more detail.
```{r Merced Graph}
m <- ggplot(Merced, mapping = aes(x = Title))
m + geom_point(mapping = aes(y = Mean.Gross.20, color = "2020 Mean Gross")) + 
  geom_point(mapping = aes(y = Inflated.20, color = "2020 Inflation Adjusted")) +
  scale_y_continuous(name = "Mean Wages", labels = label_number(suffix = "k", scale = 1e-3)) +
  theme(axis.text.x = element_text(angle = 90), legend.position = "bottom") + xlab("Position")
```
That's actually not the worst. A couple positions actually have a higher average than the 2020 calculated inflation. Coach Assistant 2, as well as some financial analysts, are doing better than inflation. So now we'll look at UC San Francisco, which is in one of the most expensive American cities to live in.
```{r San Fran Graph, echo = FALSE}
sf <- ggplot(SF, mapping = aes(x = Title))
sf + geom_point(mapping = aes(y = Mean.Gross.20, color = "2020 Mean Gross")) + 
  geom_point(mapping = aes(y = Inflated.20, color = "2020 Inflation Adjusted")) +
  scale_y_continuous(name = "Mean Wages", labels = label_number(suffix = "k", scale = 1e-3)) +
  scale_x_discrete("Title") +
  theme(axis.text.x = element_blank(), legend.position = "bottom") + xlab("Position")

SF %>% slice_max(Inflated.20)
15096.4 / 2080
15096.4 / 1040
```
Unfortunately, there are just too many job positions at UCSF to all fit on the x axis. So we stripped off the labels to prevent crowding. But this data is much more disheartening for employees. Some positions seem to be making less than 50k a year, while inflation necessitates they make almost 400k gross on average. The worst victim of this is the "Professor of Clin-HCOMP" Position. in 2020, the gross pay for this position averaged 15,096.4, which is 374,742.5 less than was made in 2019. Staff was also cut by 323 people for the same position in that time frame. Meaning that along with reduced staff members, they received a severe pay cut. They should be making 367,189.70 a year with that title at UCSF, instead the position saw a 96% pay cut. Assuming that this position is full time (which means roughly 2,080 working hours a year for an average of 40 a week), those individuals would be making roughly 7.26 an hour, and 14.52 an hour if they only worked 20 hour weeks in a part-time position (which typically means they would be without benefits). And according to the MIT Living Wage Calculator, a single adult with no children (working 2,080 hours a year) needs to be making 22.88/hour to living in the San Francisco-Oakland-Hayward area. These people cannot live with these wages. The closest they get to living on this wage (according to MIT) is if there are 2 adults and 0 children both working full time in the household. However, this only brings the living wage down to 16.23 / hour, a ~30% decrease.

Based on these graphs and data analysis, the UC System's gross earnings have not kept up with inflation in just the past 5 years. 

```{r t-test}
t.test(UCWages$Mean.Gross.20, UCWages$Inflated.20, paired = TRUE)
```
As a final check to see if we've only been observing outliers, we ran a simple paired t-test to compare the values for the Average gross pay in 2020, with what should be payed according to inflation over just 5 years. We calculated a p value of p < 2.2e-16. In long form, that's 0.00000000000000022. The standard used to say if 2 sets of data are statistically different is p < 0.05. This lends very strong evidence to our earlier statement that the UC system in the state of California does not keep up with rising costs of living, and that they are failing their employees.

